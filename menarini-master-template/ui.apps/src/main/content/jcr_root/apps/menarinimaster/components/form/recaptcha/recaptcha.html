<!--/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~ Copyright 2016 Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/-->
<div data-sly-test="${ wcmmode.edit || wcmmode.preview }" data-emptytext="${component.properties.jcr:title}" class="cq-placeholder"></div>

<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
<script type="text/javascript">
var onloadCallback = function () {
	//alert("grecaptcha is ready!");
	var publicKey = '${properties.publicKey @ context='scriptString'}'
	grecaptcha.render("g-recaptcha", { sitekey: publicKey });
  var iframe = document.getElementById("g-recaptcha").querySelector("iframe");
	iframe.setAttribute("sandbox", iframe.getAttribute("sandbox").replace("allow-scripts", "").trim());
};
var onSuccess = function (response) {
	//alert("grecaptcha is verified !" + response);
	$('#g-recaptcha-response').val(response);
};
</script>

<div id="g-recaptcha" data-callback="onSuccess"></div>
<input type="hidden" id="g-recaptcha-response" value=""/>
<div id="recaptcha-error-message" class="error-captcha"></div>




